<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1 -Basics of geological modeling with GemPy &#8212; GemPy 2023.2.0b1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=270d38c7" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=e5fbc548" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=39c4bfd0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3a: Grids." href="ch1_3a_grids.html" />
    <link rel="prev" title="Chapter 1: GemPy fundamentals" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorials-ch1-fundamentals-ch1-1-basics-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="basics-of-geological-modeling-with-gempy">
<span id="sphx-glr-tutorials-ch1-fundamentals-ch1-1-basics-py"></span><h1>1.1 -Basics of geological modeling with GemPy<a class="headerlink" href="#basics-of-geological-modeling-with-gempy" title="Permalink to this heading">¶</a></h1>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<section id="importing-necessary-libraries">
<h2>Importing Necessary Libraries<a class="headerlink" href="#importing-necessary-libraries" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">import</span> <span class="nn">gempy_viewer</span> <span class="k">as</span> <span class="nn">gpv</span>
</pre></div>
</div>
</section>
<section id="importing-and-defining-input-data">
<h2>Importing and Defining Input Data<a class="headerlink" href="#importing-and-defining-input-data" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.GeoModel</span></code></a>
GemPy uses Python objects to store the data that builds the geological model. The main data classes include:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.GeoModel</span></code></a></p></li>
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.StructuralFrame</span></code></a></p></li>
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.StructuralGroup</span></code></a></p></li>
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.StructuralElement.html#gempy.core.data.StructuralElement" title="gempy.core.data.StructuralElement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.StructuralElement</span></code></a></p></li>
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.SurfacePointsTable.html#gempy.core.data.SurfacePointsTable" title="gempy.core.data.SurfacePointsTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.SurfacePointsTable</span></code></a></p></li>
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.OrientationsTable.html#gempy.core.data.OrientationsTable" title="gempy.core.data.OrientationsTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.OrientationsTable</span></code></a></p></li>
<li><p><a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.Grid.html#gempy.core.data.Grid" title="gempy.core.data.Grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.Grid</span></code></a></p></li>
</ul>
</div></blockquote>
<p>You can also create data from raw CSV files (comma-separated values). This could be useful if you are exporting model data
from a different program or creating it in a spreadsheet software like Microsoft Excel or LibreOffice Calc.</p>
<p>In this tutorial, we’ll use CSV files to generate input data. You can find these example files in the <cite>gempy data</cite>
repository on GitHub. The data consists of x, y, and z positional values for all surface points and orientation
measurements. Additional data includes poles, azimuth and polarity (or the gradient components). Surface points are
assigned a formation, which can be a lithological unit (like “Sandstone”) or a structural feature (like “Main Fault”).</p>
<p>It’s important to note that, in GemPy, interface position points mark the <strong>bottom</strong> of a layer. If you need points
to represent the top of a formation (for example, when modeling an intrusion), you can define an inverted orientation measurement.</p>
<p>While generating data from CSV files, we also need to define the model’s real extent in x, y, and z. This extent
defines the area used for interpolation and many of the plotting functions. We also set a resolution to establish a
regular grid right away. This resolution will dictate the number of voxels used during modeling. We’re using a medium
resolution of 50x50x50 here, which results in 125,000 voxels. The model extent should enclose all relevant data in a
representative space. As our model voxels are prisms rather than cubes, the resolution can differ from the extent.
However, it is recommended to avoid going beyond 100 cells in each direction (1,000,000 voxels) to prevent excessive
computational costs.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/cgre-aachen/gempy_data/master/&#39;</span>

<a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">:</span> <a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">GeoModel</span></a> <span class="o">=</span> <a href="../../GemPy API/gempy.create_geomodel.html#gempy.create_geomodel" title="gempy.create_geomodel" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">create_geomodel</span></a><span class="p">(</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;Tutorial_ch1_1_Basics&#39;</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">750</span><span class="p">],</span>
    <span class="n">resolution</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>  <span class="c1"># * Here we define the resolution of the voxels</span>
    <span class="n">refinement</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>  <span class="c1"># * Here we define the number of octree levels. If octree levels are defined, the resolution is ignored.</span>
    <span class="n">importer_helper</span><span class="o">=</span><a href="../../Helper Classes/gempy.core.data.ImporterHelper.html#gempy.core.data.ImporterHelper" title="gempy.core.data.ImporterHelper" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ImporterHelper</span></a><span class="p">(</span>
        <span class="n">path_to_orientations</span><span class="o">=</span><span class="n">data_path</span> <span class="o">+</span> <span class="s2">&quot;/data/input_data/getting_started/simple_fault_model_orientations.csv&quot;</span><span class="p">,</span>
        <span class="n">path_to_surface_points</span><span class="o">=</span><span class="n">data_path</span> <span class="o">+</span> <span class="s2">&quot;/data/input_data/getting_started/simple_fault_model_points.csv&quot;</span><span class="p">,</span>
        <span class="n">hash_surface_points</span><span class="o">=</span><span class="s2">&quot;4cdd54cd510cf345a583610585f2206a2936a05faaae05595b61febfc0191563&quot;</span><span class="p">,</span>
        <span class="n">hash_orientations</span><span class="o">=</span><span class="s2">&quot;7ba1de060fc8df668d411d0207a326bc94a6cdca9f5fe2ed511fd4db6b3f3526&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Surface points hash:  4cdd54cd510cf345a583610585f2206a2936a05faaae05595b61febfc0191563
Orientations hash:  7ba1de060fc8df668d411d0207a326bc94a6cdca9f5fe2ed511fd4db6b3f3526
</pre></div>
</div>
<div class="admonition-new-in-gempy-3 admonition">
<p class="admonition-title">New in GemPy 3!</p>
<p>GemPy 3 has introduced the <code class="docutils literal notranslate"><span class="pre">ImporterHelper</span></code> class to streamline importing data from various sources. This class
simplifies the process of passing multiple arguments needed for importing data and will likely see further
extensions in the future. Currently, one of its uses is to handle <cite>pooch</cite> arguments for downloading data from the internet.</p>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The input data can be reviewed using the properties `surface_points` and `orientations`. However, note that at this point,</span>
<span class="c1"># the sequence of formations and their assignment to series are still arbitrary. We will rectify this in the subsequent steps.</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel.surface_points" title="gempy.core.data.GeoModel.surface_points" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-property"><span class="n">geo_model</span><span class="o">.</span><span class="n">surface_points</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table><tr><th>X</th><th>Y</th><th>Z</th><th>id</th><th>nugget</th></tr><tr><td>700.00</td><td>1000.00</td><td>300.00</td><td>23987484</td><td>0.00</td></tr><tr><td>600.00</td><td>1000.00</td><td>200.00</td><td>23987484</td><td>0.00</td></tr><tr><td>500.00</td><td>1000.00</td><td>100.00</td><td>23987484</td><td>0.00</td></tr><tr><td>1000.00</td><td>1000.00</td><td>600.00</td><td>23987484</td><td>0.00</td></tr><tr><td>1100.00</td><td>1000.00</td><td>700.00</td><td>23987484</td><td>0.00</td></tr><tr><td>1000.00</td><td>50.00</td><td>350.00</td><td>104907733</td><td>0.00</td></tr><tr><td>1000.00</td><td>150.00</td><td>333.33</td><td>104907733</td><td>0.00</td></tr><tr><td>1000.00</td><td>300.00</td><td>333.33</td><td>104907733</td><td>0.00</td></tr><tr><td>1000.00</td><td>500.00</td><td>366.67</td><td>104907733</td><td>0.00</td></tr><tr><td>1000.00</td><td>1000.00</td><td>433.33</td><td>104907733</td><td>0.00</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>1100.00</td><td>1700.00</td><td>473.33</td><td>483694126</td><td>0.00</td></tr><tr><td>1100.00</td><td>1950.00</td><td>490.00</td><td>483694126</td><td>0.00</td></tr><tr><td>0.00</td><td>1000.00</td><td>433.33</td><td>483694126</td><td>0.00</td></tr><tr><td>300.00</td><td>1000.00</td><td>400.00</td><td>483694126</td><td>0.00</td></tr><tr><td>600.00</td><td>1000.00</td><td>366.67</td><td>483694126</td><td>0.00</td></tr><tr><td>1300.00</td><td>1000.00</td><td>566.67</td><td>483694126</td><td>0.00</td></tr><tr><td>1600.00</td><td>1000.00</td><td>550.00</td><td>483694126</td><td>0.00</td></tr><tr><td>1900.00</td><td>1000.00</td><td>566.67</td><td>483694126</td><td>0.00</td></tr><tr><td>1700.00</td><td>500.00</td><td>533.33</td><td>483694126</td><td>0.00</td></tr><tr><td>1700.00</td><td>1500.00</td><td>516.67</td><td>483694126</td><td>0.00</td></tr></table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel.orientations" title="gempy.core.data.GeoModel.orientations" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-property"><span class="n">geo_model</span><span class="o">.</span><span class="n">orientations</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table><tr><th>X</th><th>Y</th><th>Z</th><th>G_x</th><th>G_y</th><th>G_z</th><th>id</th><th>nugget</th></tr><tr><td>500.00</td><td>1000.00</td><td>300.00</td><td>-0.95</td><td>-0.00</td><td>0.32</td><td>23987484</td><td>0.01</td></tr><tr><td>400.00</td><td>1000.00</td><td>420.00</td><td>0.32</td><td>0.00</td><td>0.95</td><td>249316040</td><td>0.01</td></tr><tr><td>1000.00</td><td>1000.00</td><td>300.00</td><td>0.32</td><td>0.00</td><td>0.95</td><td>375524995</td><td>0.01</td></tr></table>
</div>
<br />
<br /><section id="declaring-the-sequential-order-of-geological-formations">
<h3>Declaring the Sequential Order of Geological Formations<a class="headerlink" href="#declaring-the-sequential-order-of-geological-formations" title="Permalink to this heading">¶</a></h3>
<p>In our model, we want the geological units to appear in the correct chronological order.
Such order could be determined by a sequence of stratigraphic deposition, unconformities
due to erosion, or other lithological genesis events like igneous intrusions. A similar
age-related order is declared for faults in our model. In GemPy, we use the function
<cite>gempy.map_stack_to_surfaces</cite> to assign formations or faults to different sequential series
by declaring them in a Python dictionary.</p>
<p>The correct ordering of series is crucial for model construction! It’s possible to assign
several surfaces to one series. The order of units within a series only affects the color
code, so we recommend maintaining consistency. The order can be defined by simply changing
the order of the lists within <cite>gempy.core.data.StructuralFrame.structural_groups</cite> and
<cite>gempy.core.data.StructuralGroups.elements</cite> attributes.</p>
<p>Faults are treated as independent groups and must be younger than the groups they affect.
The relative order between different faults defines their tectonic relationship
(the first entry is the youngest).</p>
<p>For a model with simple sequential stratigraphy, all layer formations can be assigned to
one series without an issue. All unit boundaries and their order would then be determined
by interface points. However, to model more complex lithostratigraphical relations and
interactions, separate series definition becomes important. For example, modeling an
unconformity or an intrusion that disrupts older stratigraphy would require declaring a
“newer” series.</p>
<p>By default, we create a simple sequence inferred from the data:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">structural_frame</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">

        <table>
          <tr><td>Structural Groups:</td><td>
    <table style="border-left:1.2px solid black;>
      <tr><th colspan="2"><b>StructuralGroup:</b></th></tr>
      <tr><td>Name:</td><td>default_formation</td></tr>
      <tr><td>Structural Relation:</td><td>StackRelationType.ERODE</td></tr>
      <tr><td>Elements:</td><td>
    <table width="50%" style="border-left:15px solid #015482;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Main_Fault</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #9f0052;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Sandstone_1</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #ffbe00;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Sandstone_2</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #728f02;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Shale</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #443988;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Siltstone</td></tr>
    </table>
        </td></tr>
    </table>
        </td></tr>
          <tr><td>Fault Relations:</td><td><table style="border-collapse: collapse; table-layout: fixed;"><th></th><th style="transform: rotate(-35deg); height:150px; vertical-align: bottom; text-align: center;">default_fo...</th><tr><th>default_formation</th><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td></tr></table></td></tr>
          <tr><td></td><td>
        <table>
          <tr>
            <td><div style="display: inline-block; background-color: #527682; width: 20px; height: 20px; border: 1px solid black;"></div> True</td>
            <td><div style="display: inline-block; background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></div> False</td>
          </tr>
        </table>
        </td></tr>
        </table>

</div>
<br />
<br /><p>Our example model comprises four main layers (plus an underlying
basement that is automatically generated by GemPy) and one main normal
fault displacing those layers. Assuming a simple stratigraphy where each
younger unit was deposited onto the underlying older one, we can assign
these layer formations to one series called “Strat_Series”. For the
fault, we declare a respective “Fault_Series” as the first key entry in
the mapping  dictionary. We could give any other names to these
series, the formations however have to be referred to as named in the
input data.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../GemPy API/gempy.map_stack_to_surfaces.html#gempy.map_stack_to_surfaces" title="gempy.map_stack_to_surfaces" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">map_stack_to_surfaces</span></a><span class="p">(</span>
    <span class="n">gempy_model</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span>
    <span class="n">mapping_object</span><span class="o">=</span>  <span class="c1"># TODO: This mapping I do not like it too much. We should be able to do it passing the data objects directly</span>
    <span class="p">{</span>
        <span class="s2">&quot;Fault_Series&quot;</span><span class="p">:</span> <span class="s1">&#39;Main_Fault&#39;</span><span class="p">,</span>
        <span class="s2">&quot;Strat_Series&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Sandstone_2&#39;</span><span class="p">,</span> <span class="s1">&#39;Siltstone&#39;</span><span class="p">,</span> <span class="s1">&#39;Shale&#39;</span><span class="p">,</span> <span class="s1">&#39;Sandstone_1&#39;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>

<a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">structural_frame</span></a>  <span class="c1"># Display the resulting structural frame</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">

        <table>
          <tr><td>Structural Groups:</td><td>
    <table style="border-left:1.2px solid black;>
      <tr><th colspan="2"><b>StructuralGroup:</b></th></tr>
      <tr><td>Name:</td><td>Fault_Series</td></tr>
      <tr><td>Structural Relation:</td><td>StackRelationType.ERODE</td></tr>
      <tr><td>Elements:</td><td>
    <table width="50%" style="border-left:15px solid #015482;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Main_Fault</td></tr>
    </table>
        </td></tr>
    </table>
        <br>
    <table style="border-left:1.2px solid black;>
      <tr><th colspan="2"><b>StructuralGroup:</b></th></tr>
      <tr><td>Name:</td><td>Strat_Series</td></tr>
      <tr><td>Structural Relation:</td><td>StackRelationType.ERODE</td></tr>
      <tr><td>Elements:</td><td>
    <table width="50%" style="border-left:15px solid #ffbe00;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Sandstone_2</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #443988;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Siltstone</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #728f02;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Shale</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #9f0052;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Sandstone_1</td></tr>
    </table>
        </td></tr>
    </table>
        </td></tr>
          <tr><td>Fault Relations:</td><td><table style="border-collapse: collapse; table-layout: fixed;"><th></th><th style="transform: rotate(-35deg); height:150px; vertical-align: bottom; text-align: center;">Fault_Seri...</th><th style="transform: rotate(-35deg); height:150px; vertical-align: bottom; text-align: center;">Strat_Seri...</th><tr><th>Fault_Series</th><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td></tr><tr><th>Strat_Series</th><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td></tr></table></td></tr>
          <tr><td></td><td>
        <table>
          <tr>
            <td><div style="display: inline-block; background-color: #527682; width: 20px; height: 20px; border: 1px solid black;"></div> True</td>
            <td><div style="display: inline-block; background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></div> False</td>
          </tr>
        </table>
        </td></tr>
        </table>

</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">set_is_fault</span><span class="p">(</span>
    <span class="n">frame</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">structural_frame</span></a><span class="p">,</span>
    <span class="n">fault_groups</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fault_Series&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">

        <table>
          <tr><td>Structural Groups:</td><td>
    <table style="border-left:1.2px solid black;>
      <tr><th colspan="2"><b>StructuralGroup:</b></th></tr>
      <tr><td>Name:</td><td>Fault_Series</td></tr>
      <tr><td>Structural Relation:</td><td>StackRelationType.FAULT</td></tr>
      <tr><td>Elements:</td><td>
    <table width="50%" style="border-left:15px solid #527682;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Main_Fault</td></tr>
    </table>
        </td></tr>
    </table>
        <br>
    <table style="border-left:1.2px solid black;>
      <tr><th colspan="2"><b>StructuralGroup:</b></th></tr>
      <tr><td>Name:</td><td>Strat_Series</td></tr>
      <tr><td>Structural Relation:</td><td>StackRelationType.ERODE</td></tr>
      <tr><td>Elements:</td><td>
    <table width="50%" style="border-left:15px solid #ffbe00;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Sandstone_2</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #443988;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Siltstone</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #728f02;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Shale</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #9f0052;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Sandstone_1</td></tr>
    </table>
        </td></tr>
    </table>
        </td></tr>
          <tr><td>Fault Relations:</td><td><table style="border-collapse: collapse; table-layout: fixed;"><th></th><th style="transform: rotate(-35deg); height:150px; vertical-align: bottom; text-align: center;">Fault_Seri...</th><th style="transform: rotate(-35deg); height:150px; vertical-align: bottom; text-align: center;">Strat_Seri...</th><tr><th>Fault_Series</th><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td><td style="background-color: #527682; width: 20px; height: 20px; border: 1px solid black;"></td></tr><tr><th>Strat_Series</th><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td></tr></table></td></tr>
          <tr><td></td><td>
        <table>
          <tr>
            <td><div style="display: inline-block; background-color: #527682; width: 20px; height: 20px; border: 1px solid black;"></div> True</td>
            <td><div style="display: inline-block; background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></div> False</td>
          </tr>
        </table>
        </td></tr>
        </table>

</div>
<br />
<br /><p>Now, all surfaces have been assigned to a series and are displayed in the correct order
(from young to old).</p>
</section>
<section id="returning-information-from-our-input-data">
<h3>Returning Information from Our Input Data<a class="headerlink" href="#returning-information-from-our-input-data" title="Permalink to this heading">¶</a></h3>
<p>Our model input data, named “geo_model”, contains all essential information for constructing
our model. You can access different types of information by accessing the attributes.
For instance, you can retrieve the coordinates of our modeling grid as follows:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.Grid.html#gempy.core.data.Grid" title="gempy.core.data.Grid" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">grid</span></a>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.core.data.grid.Grid object at 0x7f44ed57cf40&gt;
</pre></div>
</div>
</section>
<section id="visualizing-input-data">
<h3>Visualizing input data<a class="headerlink" href="#visualizing-input-data" title="Permalink to this heading">¶</a></h3>
<p>We can also visualize our input data. This might for example be useful
to check if all points and measurements are defined the way we want them
to. Using the function <code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy_viewer.plot2d</span></code>, we attain a 2D projection of our
data points onto a plane of chosen <em>direction</em> (we can choose this
attribute to be either <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> or <span class="math notranslate nohighlight">\(z\)</span>).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_001.png" srcset="../../_images/sphx_glr_ch1_1_basics_001.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><p>Using  <a class="reference internal" href="../../Plot/gempy_viewer.plot_3d.html#gempy_viewer.plot_3d" title="gempy_viewer.plot_3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy_viewer.plot_3d</span></code></a>, # we can also visualize this data in 3D. Note that
direct 3D visualization in GemPy requires <a class="reference external" href="https://www.vtk.org/">the Visualization
Toolkit</a> (VTK) to be installed.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpv</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plotter_type</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_002.png" srcset="../../_images/sphx_glr_ch1_1_basics_002.png" alt="ch1 1 basics" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy_viewer.modules.plot_3d.vista.GemPyToVista object at 0x7f44ed57c9a0&gt;
</pre></div>
</div>
</section>
<section id="model-generation">
<h3>Model Generation<a class="headerlink" href="#model-generation" title="Permalink to this heading">¶</a></h3>
<p>Once we’ve correctly defined all our primary information in our
<cite>gempy.core.data.GeoModel</cite> object (referred to as <cite>geo_model</cite> in these tutorials),
we can proceed to the next step: preparing the input data for interpolation.</p>
<div class="admonition-new-in-gempy-3-numpy-and-tensorflow-backend admonition">
<p class="admonition-title">New in GemPy 3!  Numpy and TensorFlow backend</p>
<p>Unlike previous versions, GemPy 3 doesn’t rely on <cite>theano</cite> or <cite>asera</cite>.
Instead, it utilizes <cite>numpy</cite> or <cite>tensorflow</cite>. Consequently, we no longer need
to recompile all theano functions (TensorFlow uses eager execution; we found no
notable speed difference after profiling the XLA compiler).</p>
</div>
<p>The parameters used for the interpolation are stored in
<cite>gempy.core.data.GeoModel.interpolation_options</cite>. These parameters have sensible default values
that you can modify if necessary. However, we advise caution when changing these parameters
unless you fully understand their implications.</p>
<p>Display the current interpolation options</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><span class="n">interpolation_options</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">

                <table>
                    <tr><td colspan='2' style='text-align:center'><b>InterpolationOptions</b></td></tr>
                    <tr><td>kernel_options</td><td>{'range': 5, 'c_o': 10, 'uni_degree': 1, 'i_res': 4, 'gi_res': 2, 'number_dimensions': 3, 'kernel_function': <AvailableKernelFunctions.cubic: KernelFunction(base_function=<function cubic_function at 0x7f4546ac7910>, derivative_div_r=<function cubic_function_p_div_r at 0x7f4546ac79a0>, second_derivative=<function cubic_function_a at 0x7f4546ac7a30>, consume_sq_distance=False)>, 'compute_condition_number': False, 'kernel_solver': <Solvers.DEFAULT: 1>}</td></tr><tr><td>number_octree_levels</td><td>4</td></tr><tr><td>current_octree_level</td><td>0</td></tr><tr><td>compute_scalar_gradient</td><td>False</td></tr><tr><td>mesh_extraction</td><td>True</td></tr><tr><td>mesh_extraction_masking_options</td><td>MeshExtractionMaskingOptions.INTERSECT</td></tr><tr><td>mesh_extraction_fancy</td><td>True</td></tr><tr><td>debug</td><td>True</td></tr><tr><td>debug_water_tight</td><td>False</td></tr><tr><td>_number_octree_levels_surface</td><td>4</td></tr>
                </table>

</div>
<br />
<br /><p>With all our prerequisites in place, we can now compute our complete geological model
using <a class="reference internal" href="../../GemPy%20API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">gempy.compute_model()</span></code></a>. This function returns a <a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.Solutions.html#gempy.core.data.Solutions" title="gempy.core.data.Solutions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.Solutions</span></code></a> object.</p>
<p>The following sections illustrate these different model solutions and how to utilize them.</p>
<p>Compute the geological model and get the solutions</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <a href="../../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting Backend To: AvailableBackends.numpy
/home/leguark/gempy/gempy/core/data/geo_model.py:164: UserWarning: You are using octrees and passing a regular grid. The resolution of the regular grid will be overwritten
  warnings.warn(
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<b>Solutions:</b> 4 Octree Levels, 5 DualContouringMeshes
</div>
<br />
<br /><p>Solutions are also stored within the <a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.GeoModel</span></code></a> object, for future reference.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><span class="n">solutions</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<b>Solutions:</b> 4 Octree Levels, 5 DualContouringMeshes
</div>
<br />
<br /></section>
<section id="direct-model-visualization-in-gempy">
<h3>Direct model visualization in GemPy<a class="headerlink" href="#direct-model-visualization-in-gempy" title="Permalink to this heading">¶</a></h3>
<p>Model solutions can be easily visualized in 2D sections in GemPy
directly. Let’s take a look at our lithology block:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="s2">&quot;mid&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_003.png" srcset="../../_images/sphx_glr_ch1_1_basics_003.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy_viewer.modules.plot_2d.visualization_2d.Plot2D object at 0x7f44ed6dd450&gt;
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">cell_number=mid</span></code>, we have chosen a section going through
the middle of our block. We have moved in <code class="docutils literal notranslate"><span class="pre">direction='y'</span></code>,
the plot thus depicts a plane parallel to the <span class="math notranslate nohighlight">\(x\)</span>- and
<span class="math notranslate nohighlight">\(y\)</span>-axes. Setting <code class="docutils literal notranslate"><span class="pre">show_data=True</span></code>, we could plot original data
together with the results. Changing the values for <code class="docutils literal notranslate"><span class="pre">cell_number</span></code> and
<code class="docutils literal notranslate"><span class="pre">direction</span></code>, we can move through our 3D block model and explore it by
looking at different 2D planes.</p>
<p>We can do the same with the underlying scalar-field solution:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span>
    <span class="n">series_n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># This will plot the scalar field used for the fault</span>
    <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_004.png" srcset="../../_images/sphx_glr_ch1_1_basics_004.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy_viewer.modules.plot_2d.visualization_2d.Plot2D object at 0x7f44ed57c9a0&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span>
    <span class="n">series_n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># This will plot the scalar field used for the stratigraphy</span>
    <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_005.png" srcset="../../_images/sphx_glr_ch1_1_basics_005.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy_viewer.modules.plot_2d.visualization_2d.Plot2D object at 0x7f44ed6dfd60&gt;
</pre></div>
</div>
</section>
<section id="dual-contouring-and-vtk-visualization">
<h3>Dual Contouring and vtk visualization<a class="headerlink" href="#dual-contouring-and-vtk-visualization" title="Permalink to this heading">¶</a></h3>
<p>In addition to 2D sections we can extract surfaces to visualize in 3D
renderers. Surfaces can be visualized as 3D triangle complexes in VTK
(see function plot_surfaces_3D below). To create these triangles, we
need to extract respective vertices and simplices from the potential
fields of lithologies and faults. This process is automatized in GemPy
using dual contouring in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy_engine</span></code>.</p>
<div class="admonition-new-in-gempy-3-dual-contouring admonition">
<p class="admonition-title">New in GemPy 3! Dual Contouring</p>
<p>GemPy 3 uses dual contouring to extract surfaces from the scalar fields. The method is completely coded in <code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy_engine</span></code> what also
enables further improvements in the midterm. This method is more efficient to use
together with octrees and suited better the new capabilities of gempy3.</p>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpv</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plotter_type</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_006.png" srcset="../../_images/sphx_glr_ch1_1_basics_006.png" alt="ch1 1 basics" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy_viewer.modules.plot_3d.vista.GemPyToVista object at 0x7f44f09f1000&gt;
</pre></div>
</div>
</section>
<section id="adding-topography">
<h3>Adding topography<a class="headerlink" href="#adding-topography" title="Permalink to this heading">¶</a></h3>
<p>In gempy we can add more grid types for different purposes. We will explore this concept in more detail in the
next tutorials (<a class="reference internal" href="ch1_3a_grids.html"><span class="doc">1.3a: Grids.</span></a>). For now, we will just add a topography grid to our model. This grid allows us to intersect the
surfaces as well as compute a high resolution geological mal.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">set_topography_from_random</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.Grid.html#gempy.core.data.Grid" title="gempy.core.data.Grid" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">grid</span></a><span class="p">,</span>
    <span class="n">fractal_dimension</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
    <span class="n">d_z</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">350</span><span class="p">,</span> <span class="mi">750</span><span class="p">]),</span>
    <span class="n">topography_resolution</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
<span class="p">)</span>

<a href="../../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
<span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_topography</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">gpv</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span>
    <span class="n">plotter_type</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">,</span>
    <span class="n">show_topography</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_surfaces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_lith</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ch1_1_basics_007.png" srcset="../../_images/sphx_glr_ch1_1_basics_007.png" alt="ch1 1 basics" class = "sphx-glr-single-img"/><img src="../../_images/sphx_glr_ch1_1_basics_008.png" srcset="../../_images/sphx_glr_ch1_1_basics_008.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;topography&#39;]
Setting Backend To: AvailableBackends.numpy

&lt;gempy_viewer.modules.plot_3d.vista.GemPyToVista object at 0x7f44f06aa440&gt;
</pre></div>
</div>
</section>
<section id="compute-at-a-given-location">
<h3>Compute at a given location<a class="headerlink" href="#compute-at-a-given-location" title="Permalink to this heading">¶</a></h3>
<p>This is done by modifying the grid to a custom grid and recomputing.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_i</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_values_at_coords</span></a><span class="p">:</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></a> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">compute_model_at</span><span class="p">(</span>
    <span class="n">gempy_model</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span>
    <span class="n">at</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_i</span></a>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_values_at_coords</span></a>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;custom&#39; &#39;topography&#39;]
Setting Backend To: AvailableBackends.numpy

array([2.])
</pre></div>
</div>
<p>Therefore if we just want the value at <strong>x_i</strong>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">raw_arrays</span><span class="o">.</span><span class="n">custom</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([2.])
</pre></div>
</div>
<div class="admonition-work-in-progress admonition">
<p class="admonition-title">Work in progress</p>
<p>GemPy3 model serialization is currently being redisigned. Therefore, at the current version, there is not a build in
method to save the model. However, since now the data model should be completely robust, you should be able to save the
<a class="reference internal" href="../../Modeling%20Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gempy.core.data.GeoModel</span></code></a> and all its attributes using the standard python library [pickle](<a class="reference external" href="https://docs.python.org/3/library/pickle.html">https://docs.python.org/3/library/pickle.html</a>)</p>
</div>
<p>sphinx_gallery_thumbnail_number = -2</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  7.936 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-ch1-fundamentals-ch1-1-basics-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a03e308a516f31e307271cf1d2da8dd7/ch1_1_basics.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">ch1_1_basics.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1ef626a0812b526fc9f23dae6a073ffd/ch1_1_basics.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">ch1_1_basics.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=gempy-project&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">Additional projects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">GemPy Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#chapter-1-gempy-fundamentals">Chapter 1: GemPy fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#chapter-3-domain-kriging">Chapter 3: Domain Kriging</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#chapter-4-topological-analysis">Chapter 4: Topological analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Simple geometries</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html#data-classes">Data Classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">GemPy Tutorials</a><ul>
  <li><a href="index.html">Chapter 1: GemPy fundamentals</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Chapter 1: GemPy fundamentals</a></li>
      <li>Next: <a href="ch1_3a_grids.html" title="next chapter">1.3a: Grids.</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2023, Gempy Developers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/tutorials/ch1_fundamentals/ch1_1_basics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>